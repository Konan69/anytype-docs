"use strict";(self.webpackChunkanytype_docs=self.webpackChunkanytype_docs||[]).push([[567],{1263:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"anytype_documentation","title":"Anytype: Technical Documentation and Architecture Analysis","description":"Overview","source":"@site/docs/anytype_documentation.md","sourceDirName":".","slug":"/anytype_documentation","permalink":"/anytype-docs/docs/anytype_documentation","draft":false,"unlisted":false,"editUrl":"https://github.com/konan69/anytype-docs/tree/main/docs/anytype_documentation.md","tags":[],"version":"current","frontMatter":{"id":"anytype_documentation","title":"Anytype: Technical Documentation and Architecture Analysis","sidebar_label":"Main Documentation"},"sidebar":"tutorialSidebar","next":{"title":"Component Relationships","permalink":"/anytype-docs/docs/anytype_component_relationships"}}');var s=i(4848),r=i(8453);const c={id:"anytype_documentation",title:"Anytype: Technical Documentation and Architecture Analysis",sidebar_label:"Main Documentation"},o="Anytype: Technical Documentation and Architecture Analysis",a={},l=[{value:"Overview",id:"overview",level:2},{value:"Project Structure",id:"project-structure",level:2},{value:"Component Analysis",id:"component-analysis",level:2},{value:"anytype-ts",id:"anytype-ts",level:3},{value:"Directory Structure",id:"directory-structure",level:4},{value:"Key Features",id:"key-features",level:4},{value:"State Management",id:"state-management",level:4},{value:"Component Structure",id:"component-structure",level:4},{value:"anytype-heart",id:"anytype-heart",level:3},{value:"Directory Structure",id:"directory-structure-1",level:4},{value:"Service Architecture",id:"service-architecture",level:4},{value:"Core Services and Business Logic",id:"core-services-and-business-logic",level:4},{value:"Data Storage",id:"data-storage",level:4},{value:"any-block",id:"any-block",level:3},{value:"Data Model",id:"data-model",level:4},{value:"CRDT Implementation",id:"crdt-implementation",level:4},{value:"any-sync-dockercompose",id:"any-sync-dockercompose",level:3},{value:"Frontend-Backend Integration",id:"frontend-backend-integration",level:2},{value:"Technical Architecture",id:"technical-architecture",level:2},{value:"Overall Architecture",id:"overall-architecture",level:3},{value:"Communication Flow",id:"communication-flow",level:3},{value:"Data Management",id:"data-management",level:3},{value:"Synchronization Architecture",id:"synchronization-architecture",level:3},{value:"Core Components and Technologies",id:"core-components-and-technologies",level:2},{value:"Frontend (anytype-ts)",id:"frontend-anytype-ts",level:3},{value:"Backend (anytype-heart)",id:"backend-anytype-heart",level:3},{value:"Communications",id:"communications",level:3},{value:"Implementation Details",id:"implementation-details",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"anytype-technical-documentation-and-architecture-analysis",children:"Anytype: Technical Documentation and Architecture Analysis"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Anytype is a privacy-focused, offline-first personal knowledge management system that allows users to create, connect, and organize information using various object types and relationships. The application is built with a distributed architecture that supports local-first operation with optional sync capabilities."}),"\n",(0,s.jsx)(n.p,{children:"This documentation provides a comprehensive analysis of the Anytype codebase, including its architecture, components, and how they interact with each other."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note:"})," This document provides a high-level overview of the Anytype system. For more detailed analysis of specific components, refer to the component-specific documentation files in the ",(0,s.jsx)(n.code,{children:"component_docs/"})," directory."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,s.jsx)(n.p,{children:"The Anytype project is composed of several key components:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"anytype-ts"}),": The frontend application built with TypeScript, Electron, and React"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"anytype-heart"}),": The backend core engine written in Go"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"any-block"}),": Protocol definitions for data structures and communications"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"anysync"}),": Synchronization infrastructure components"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"any-sync-dockercompose"}),": Docker setup for running the sync infrastructure"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Each component plays a specific role in the overall system and communicates with others through well-defined interfaces."}),"\n",(0,s.jsx)(n.h2,{id:"component-analysis",children:"Component Analysis"}),"\n",(0,s.jsx)(n.h3,{id:"anytype-ts",children:"anytype-ts"}),"\n",(0,s.jsx)(n.p,{children:"Anytype-ts is the official Anytype client for MacOS, Linux, and Windows. It serves as the frontend application that users interact with directly. This component is built using:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TypeScript/JavaScript"}),": For application logic"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Electron"}),": To create a cross-platform desktop application"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"React"}),": For the user interface"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The application is designed to communicate with the anytype-heart middleware, which handles core functionality and data management."}),"\n",(0,s.jsx)(n.h4,{id:"directory-structure",children:"Directory Structure"}),"\n",(0,s.jsx)(n.p,{children:"The frontend code is organized as follows:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"src/ts/"}),": Contains the TypeScript source code","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"app.tsx"}),": Main application entry point"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"component/"}),": React components"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"model/"}),": Data models"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"store/"}),": State management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"interface/"}),": TypeScript interfaces"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"lib/"}),": Utility functions and libraries"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"hook/"}),": React hooks"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The frontend follows a component-based architecture with React, using MobX for state management. The main application is initialized in ",(0,s.jsx)(n.code,{children:"app.tsx"}),", which sets up the React router, event handlers, and core application state."]}),"\n",(0,s.jsx)(n.h4,{id:"key-features",children:"Key Features"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cross-platform desktop application support using Electron"}),"\n",(0,s.jsx)(n.li,{children:"React-based user interface with a component-driven architecture"}),"\n",(0,s.jsx)(n.li,{children:"MobX for state management"}),"\n",(0,s.jsx)(n.li,{children:"Communication with the middleware via IPC (Inter-Process Communication)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"state-management",children:"State Management"}),"\n",(0,s.jsxs)(n.p,{children:["The frontend uses MobX for state management, with multiple stores handling different aspects of the application state. The main stores are defined in ",(0,s.jsx)(n.code,{children:"anytype-ts/src/ts/store/"}),":"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Block Store"})," (",(0,s.jsx)(n.code,{children:"store/block.ts"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages block data structures that form the content of pages"}),"\n",(0,s.jsx)(n.li,{children:"Contains maps for blocks, tree structures, and restrictions"}),"\n",(0,s.jsx)(n.li,{children:"Handles operations like adding, updating, and deleting blocks"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Record Store"})," (",(0,s.jsx)(n.code,{children:"store/record.ts"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages records/objects and their relationships"}),"\n",(0,s.jsx)(n.li,{children:"Maintains maps for relations, views, and metadata"}),"\n",(0,s.jsx)(n.li,{children:"Handles operations like filtering, sorting, and displaying objects"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Common Store"})," (",(0,s.jsx)(n.code,{children:"store/common.ts"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages application-wide state"}),"\n",(0,s.jsx)(n.li,{children:"Contains settings, theme information, and global UI state"}),"\n",(0,s.jsx)(n.li,{children:"Handles operations like navigation, UI updates, and global settings"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Detail Store"})," (",(0,s.jsx)(n.code,{children:"store/detail.ts"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages object details and properties"}),"\n",(0,s.jsx)(n.li,{children:"Contains methods for handling object relations and properties"}),"\n",(0,s.jsx)(n.li,{children:"Provides functionality for filtering and querying object data"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"These stores interact with each other to maintain the application state and are accessed by React components through the MobX provider pattern."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["For a detailed analysis of the frontend state management, see ",(0,s.jsx)(n.a,{href:"/anytype-docs/docs/frontend/stores",children:"Frontend State Management Documentation"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"component-structure",children:"Component Structure"}),"\n",(0,s.jsxs)(n.p,{children:["The React components are organized in ",(0,s.jsx)(n.code,{children:"anytype-ts/src/ts/component/"})," with a modular approach:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Block components"}),": Handle rendering of different block types (text, image, link, etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"UI components"}),": Generic UI elements like buttons, menus, popups"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Page components"}),": Complete page layouts and structures"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Functionality components"}),": Components that handle specific features like search, navigation"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Key component files include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"component/block/index.tsx"}),": Main block component that renders different block types"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"component/page/index.tsx"}),": Main page component for rendering complete pages"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"component/header/index.tsx"}),": Header component for navigation and controls"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"anytype-heart",children:"anytype-heart"}),"\n",(0,s.jsx)(n.p,{children:"Anytype-heart is the middleware library for Anytype, distributed as part of the Anytype clients. It serves as the backend core engine responsible for:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Data management"}),"\n",(0,s.jsx)(n.li,{children:"Business logic implementation"}),"\n",(0,s.jsx)(n.li,{children:"Communication with sync infrastructure"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The component is written in Go and follows a service-oriented architecture, using a Service Locator pattern for dependency injection through their custom implementation: ",(0,s.jsx)(n.code,{children:"github.com/anyproto/any-sync/app"}),"."]}),"\n",(0,s.jsx)(n.h4,{id:"directory-structure-1",children:"Directory Structure"}),"\n",(0,s.jsx)(n.p,{children:"The backend code is organized as follows:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"core/"}),": Contains the main business logic","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"anytype/"}),": Core services and bootstrap functionality"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"block/"}),": Block-related operations and data structures"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"application/"}),": Application services"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"subscription/"}),": Subscription management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"files/"}),": File management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"indexer/"}),": Search indexing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"identity/"}),": Identity management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"space/"}),": Space-related functionality"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"service-architecture",children:"Service Architecture"}),"\n",(0,s.jsxs)(n.p,{children:["The backend follows a modular service-oriented architecture. Each service is registered with the application during bootstrap in ",(0,s.jsx)(n.code,{children:"core/anytype/bootstrap.go"}),". The application uses a Service Locator pattern, where services are registered with the application and can be retrieved by their interface types."]}),"\n",(0,s.jsx)(n.p,{children:"The bootstrap process initializes various services such as:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Data storage services (ftsearch, objectstore, filestore)"}),"\n",(0,s.jsx)(n.li,{children:"Core functionality services (block, subscription, collection)"}),"\n",(0,s.jsx)(n.li,{children:"Communication services (server, pool, clientserver)"}),"\n",(0,s.jsx)(n.li,{children:"Sync-related services (spacecore, streampool, virtualspaceservice)"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"core-services-and-business-logic",children:"Core Services and Business Logic"}),"\n",(0,s.jsx)(n.p,{children:"The core functionality of anytype-heart is implemented through various services, each responsible for a specific aspect of the application:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Block Service"})," (",(0,s.jsx)(n.code,{children:"anytype-heart/core/block.go"})," and ",(0,s.jsx)(n.code,{children:"anytype-heart/core/block/"})," directory):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implements block-related operations like creation, deletion, and updates"}),"\n",(0,s.jsx)(n.li,{children:"Handles block data structures and their relationships"}),"\n",(0,s.jsx)(n.li,{children:"Manages block content and formatting"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["For a detailed analysis of the Block Service, see ",(0,s.jsx)(n.a,{href:"/anytype-docs/docs/backend/block_service",children:"Block Service Documentation"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Object Service"})," (",(0,s.jsx)(n.code,{children:"anytype-heart/core/object.go"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages objects, their properties, and relationships"}),"\n",(0,s.jsx)(n.li,{children:"Handles object creation, deletion, and updates"}),"\n",(0,s.jsx)(n.li,{children:"Implements object querying and filtering"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["For a detailed analysis of the Object Store, see ",(0,s.jsx)(n.a,{href:"/anytype-docs/docs/backend/object_store",children:"Object Store Documentation"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Space Service"})," (",(0,s.jsx)(n.code,{children:"anytype-heart/core/space.go"})," and ",(0,s.jsx)(n.code,{children:"anytype-heart/space/"})," directory):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages spaces, which are containers for objects"}),"\n",(0,s.jsx)(n.li,{children:"Handles space creation, deletion, and updates"}),"\n",(0,s.jsx)(n.li,{children:"Implements access control and sharing functionality"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Subscription Service"})," (",(0,s.jsx)(n.code,{children:"anytype-heart/core/subscription/"})," directory):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages subscriptions to objects and spaces"}),"\n",(0,s.jsx)(n.li,{children:"Handles subscription creation, deletion, and updates"}),"\n",(0,s.jsx)(n.li,{children:"Implements subscription querying and filtering"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"data-storage",children:"Data Storage"}),"\n",(0,s.jsx)(n.p,{children:"The backend uses multiple storage mechanisms for different types of data:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Object Store"})," (",(0,s.jsx)(n.code,{children:"anytype-heart/pkg/lib/localstore/objectstore/"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Stores object data and metadata"}),"\n",(0,s.jsx)(n.li,{children:"Implements querying and indexing functionality"}),"\n",(0,s.jsx)(n.li,{children:"Uses Badger as the underlying key-value store"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"File Store"})," (",(0,s.jsx)(n.code,{children:"anytype-heart/pkg/lib/localstore/filestore/"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Stores file data and metadata"}),"\n",(0,s.jsx)(n.li,{children:"Implements file querying and indexing functionality"}),"\n",(0,s.jsx)(n.li,{children:"Handles file uploads and downloads"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Full-Text Search"})," (",(0,s.jsx)(n.code,{children:"anytype-heart/pkg/lib/localstore/ftsearch/"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Implements full-text search functionality"}),"\n",(0,s.jsx)(n.li,{children:"Indexes object content for efficient searching"}),"\n",(0,s.jsx)(n.li,{children:"Provides query capabilities for searching objects"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"any-block",children:"any-block"}),"\n",(0,s.jsx)(n.p,{children:"Any-block defines the protocol describing data structures used in the Anytype software. It uses Protocol Buffers (Protobuf) to efficiently describe structured data in a binary format for network communication and storage. The key components of any-block are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"models.proto"}),": Describes the base data structures used to represent objects and their components"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"changes.proto"}),": Outlines CRDT (Conflict-free Replicated Data Type) changes of objects and their blocks"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"events.proto"}),": Describes events about changes to objects and blocks, used for client notifications and as CRDT changes"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"data-model",children:"Data Model"}),"\n",(0,s.jsx)(n.p,{children:"The core data model in Anytype revolves around the following key concepts:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"SmartBlock"})," (",(0,s.jsx)(n.code,{children:"any-block/models.proto"}),", lines 11-22):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:"message SmartBlockSnapshotBase {\n    repeated Block blocks = 1;\n    google.protobuf.Struct details = 2;\n    google.protobuf.Struct fileKeys = 3 [deprecated=true];\n    repeated Relation extraRelations = 4 [deprecated=true];\n    repeated string objectTypes = 5;\n    google.protobuf.Struct collections = 6;\n    repeated string removedCollectionKeys = 8;\n    repeated RelationLink relationLinks = 7;\n    string key = 9;\n    int64 originalCreatedTimestamp = 10;\n    FileInfo fileInfo = 11;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"This is the fundamental data container that can represent various types of content."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Block"})," (defined in ",(0,s.jsx)(n.code,{children:"any-block/models.proto"}),"):\nComponents within a SmartBlock representing different types of content (text, file, link, etc.). The block structure includes:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Block ID and type information"}),"\n",(0,s.jsx)(n.li,{children:"Content-specific fields based on the block type"}),"\n",(0,s.jsx)(n.li,{children:"Layout and styling information"}),"\n",(0,s.jsx)(n.li,{children:"Child block references for hierarchical structures"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Change"})," (",(0,s.jsx)(n.code,{children:"any-block/changes.proto"}),", lines 9-22):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-protobuf",children:"message Change {\n    // set of actions to apply\n    repeated Content content = 3;\n    // snapshot - when not null, the Content will be ignored\n    Snapshot snapshot = 4;\n    // file keys related to changes content\n    repeated FileKeys fileKeys = 6;\n    // creation timestamp\n    int64 timestamp = 7;\n\n    // version of business logic\n    uint32 version = 8;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"This structure represents changes to objects and blocks, used for CRDT-based conflict resolution."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"crdt-implementation",children:"CRDT Implementation"}),"\n",(0,s.jsx)(n.p,{children:"The system uses Conflict-free Replicated Data Types (CRDTs) for handling concurrent changes, which allows for conflict-free updates in a distributed environment. The CRDT implementation in Anytype is operation-based, focusing on representing changes as operations that can be applied in any order while still converging to the same state."}),"\n",(0,s.jsx)(n.p,{children:"Key aspects of the CRDT implementation include:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Operation-based approach using changes and updates"}),"\n",(0,s.jsx)(n.li,{children:"Lamport timestamps for ordering operations"}),"\n",(0,s.jsx)(n.li,{children:"Tree-based structure for representing document hierarchies"}),"\n",(0,s.jsx)(n.li,{children:"Custom conflict resolution strategies for different data types"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["For a detailed analysis of the CRDT implementation, see ",(0,s.jsx)(n.a,{href:"/anytype-docs/docs/sync/",children:"CRDT and Sync Mechanism Documentation"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"any-sync-dockercompose",children:"any-sync-dockercompose"}),"\n",(0,s.jsx)(n.p,{children:"This component provides Docker configurations for self-hosting the any-sync network, which is the synchronization infrastructure for Anytype. It includes:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Docker Compose configuration for setting up the sync infrastructure"}),"\n",(0,s.jsx)(n.li,{children:"Configuration files for different deployment scenarios"}),"\n",(0,s.jsx)(n.li,{children:"Scripts for initializing and managing the infrastructure"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"frontend-backend-integration",children:"Frontend-Backend Integration"}),"\n",(0,s.jsx)(n.p,{children:"The frontend (anytype-ts) and backend (anytype-heart) are tightly integrated yet maintain a clear separation of concerns. The integration relies on several key mechanisms:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Binary Embedding"}),": The anytype-heart backend is compiled into a binary and embedded within the anytype-ts frontend application. This allows the frontend to communicate with the backend through a local process, eliminating the need for a separate backend server."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"IPC Communication"}),": The frontend communicates with the backend through Electron's Inter-Process Communication (IPC) mechanism. Key files involved in this communication include:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"anytype-ts/electron.js"}),": Sets up IPC handlers in the main process"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"anytype-ts/src/ts/lib/api.ts"}),": Provides the API wrapper for making IPC calls"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"anytype-ts/src/ts/lib/renderer.ts"}),": Manages the communication with the IPC bridge"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"anytype-heart/pkg/lib/gateway/gateway.go"}),": Handles IPC requests on the backend side"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Command Pattern"}),": The frontend implements a command pattern for backend operations, with each command represented as a function that constructs a Protocol Buffer request. This pattern allows for a clean separation between the frontend and backend, with well-defined interfaces."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Event System"}),": A bidirectional event system allows the backend to notify the frontend of changes, which then updates its state accordingly. The event system is implemented using Electron's IPC events, with the backend emitting events and the frontend subscribing to them."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Data Mappers"}),": Mappers convert between Protocol Buffer objects and JavaScript objects to ensure consistent data structures. These mappers are implemented in various files throughout the codebase, such as ",(0,s.jsx)(n.code,{children:"anytype-ts/src/ts/lib/api.ts"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["For a detailed analysis of the frontend-backend integration, see ",(0,s.jsx)(n.a,{href:"/anytype-docs/docs/integration/",children:"Frontend-Backend Integration Documentation"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"technical-architecture",children:"Technical Architecture"}),"\n",(0,s.jsx)(n.h3,{id:"overall-architecture",children:"Overall Architecture"}),"\n",(0,s.jsx)(n.p,{children:"Based on the analysis, Anytype follows a client-server architecture with an offline-first approach:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"The frontend (anytype-ts) provides the user interface and communicates with the middleware"}),"\n",(0,s.jsx)(n.li,{children:"The middleware (anytype-heart) implements the core functionality and data management"}),"\n",(0,s.jsx)(n.li,{children:"The protocol definitions (any-block) define how data is structured and communicated"}),"\n",(0,s.jsx)(n.li,{children:"The sync infrastructure (anysync, any-sync-dockercompose) enables data synchronization between devices"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The system is designed to work offline by default, with synchronization as an optional feature. This approach ensures user data remains available and editable even without an internet connection."}),"\n",(0,s.jsx)(n.h3,{id:"communication-flow",children:"Communication Flow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User Interaction"}),": User interacts with the UI in the Electron application (anytype-ts)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IPC Communication"}),": Frontend sends commands to the middleware through Electron's IPC mechanism"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Business Logic"}),": Middleware (anytype-heart) processes commands and applies business logic"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Data Storage"}),": Changes are stored locally using various storage mechanisms (object store, file store, etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Synchronization"}),": If enabled, changes are synchronized with other devices through the sync infrastructure"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"data-management",children:"Data Management"}),"\n",(0,s.jsx)(n.p,{children:"The system uses a CRDT-based approach for data management, which enables:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Conflict-free updates in a distributed environment"}),"\n",(0,s.jsx)(n.li,{children:"Offline-first operation with eventual consistency"}),"\n",(0,s.jsx)(n.li,{children:"Efficient synchronization between devices"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The data is stored locally using several storage mechanisms:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Object store for structured data"}),"\n",(0,s.jsx)(n.li,{children:"File store for attachments and large files"}),"\n",(0,s.jsx)(n.li,{children:"Full-text search index for efficient querying"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"synchronization-architecture",children:"Synchronization Architecture"}),"\n",(0,s.jsx)(n.p,{children:"The synchronization is implemented in the anysync component, with several key components:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Network Layer"})," (implemented in ",(0,s.jsx)(n.code,{children:"anytype-heart/space/spacecore/"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Handles peer-to-peer communication"}),"\n",(0,s.jsx)(n.li,{children:"Manages connections and data transfer"}),"\n",(0,s.jsx)(n.li,{children:"Implements transport protocols (QUIC, Yamux)"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Space Synchronization"})," (implemented in ",(0,s.jsx)(n.code,{children:"anytype-heart/space/spacecore/"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages space data synchronization"}),"\n",(0,s.jsx)(n.li,{children:"Handles conflict resolution using CRDTs"}),"\n",(0,s.jsx)(n.li,{children:"Implements access control and permissions"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"File Synchronization"})," (implemented in ",(0,s.jsx)(n.code,{children:"anytype-heart/core/filestorage/filesync/"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages file data synchronization"}),"\n",(0,s.jsx)(n.li,{children:"Handles large file transfers"}),"\n",(0,s.jsx)(n.li,{children:"Implements chunking and resume capabilities"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Identity Management"})," (implemented in ",(0,s.jsx)(n.code,{children:"anytype-heart/core/identity/"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manages user identities and authentication"}),"\n",(0,s.jsx)(n.li,{children:"Handles key management and signatures"}),"\n",(0,s.jsx)(n.li,{children:"Implements secure communication channels"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"core-components-and-technologies",children:"Core Components and Technologies"}),"\n",(0,s.jsx)(n.h3,{id:"frontend-anytype-ts",children:"Frontend (anytype-ts)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Electron"}),": Cross-platform desktop application framework"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"React"}),": UI component library"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TypeScript"}),": Typed JavaScript for better developer experience"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MobX"}),": State management library"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"React Router"}),": Navigation management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Webpack/Rspack"}),": Build tools"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"backend-anytype-heart",children:"Backend (anytype-heart)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Go"}),": Programming language for the middleware"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Protocol Buffers"}),": Data serialization format"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CRDT"}),": Conflict-free replicated data types for distributed data management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Service Locator Pattern"}),": For dependency injection and component management"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Badger"}),": Key-value database"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Full-text search"}),": For indexing and searching content"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"communications",children:"Communications"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Protocol Buffers"}),": For efficient data serialization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IPC (Inter-Process Communication)"}),": For communication between frontend and backend"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"P2P (Peer-to-Peer)"}),": For device-to-device synchronization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"QUIC/Yamux"}),": Network transport protocols"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,s.jsx)(n.p,{children:"For detailed implementation examples and analyses of specific components, refer to the component-specific documentation files:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/anytype-docs/docs/frontend/stores",children:"Frontend State Management"}),": Analysis of the MobX-based state management in the frontend"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/anytype-docs/docs/integration/",children:"Frontend-Backend Integration"}),": Analysis of how the frontend and backend communicate"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/anytype-docs/docs/backend/block_service",children:"Block Service"}),": Analysis of the block-related functionality in the backend"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/anytype-docs/docs/backend/object_store",children:"Object Store"}),": Analysis of the object storage implementation in the backend"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/anytype-docs/docs/sync/",children:"CRDT and Sync Mechanism"}),": Analysis of the CRDT-based synchronization mechanism"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(n.p,{children:"Anytype implements a sophisticated architecture that enables privacy-focused, offline-first knowledge management with seamless synchronization. The clear separation of concerns, combined with well-defined interfaces between components, creates a maintainable and extensible system."}),"\n",(0,s.jsx)(n.p,{children:"The use of advanced technologies such as CRDTs, Protocol Buffers, and reactive state management allows Anytype to provide a responsive user experience while maintaining data consistency across devices, even in challenging network conditions."}),"\n",(0,s.jsx)(n.p,{children:"This documentation provides insights into both the high-level architecture and specific implementation details of the Anytype system. For a more detailed analysis of specific components, refer to the component-specific documentation files in the corresponding directories."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>o});var t=i(6540);const s={},r=t.createContext(s);function c(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);